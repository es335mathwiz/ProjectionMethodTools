Notebook[{

Cell[CellGroupData[{
Cell["Debug Derivatives", "Title",
 CellChangeTimes->{{3.617200550708066*^9, 3.6172005561887484`*^9}}],

Cell["Gary S. Anderson", "Author",
 CellChangeTimes->{{3.6172005766837215`*^9, 3.617200602415076*^9}}],

Cell[CellGroupData[{

Cell["Debug using Luca\[CloseCurlyQuote]s Financial Market Model", "Section",
 CellChangeTimes->{{3.6172006065601263`*^9, 3.6172006252849464`*^9}, {
  3.6172009262594585`*^9, 3.6172009635524197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$OperatingSystem", "===", "\"\<Windows\>\""}], ",", 
    RowBox[{
    "SetDirectory", "[", 
     "\"\<g:/git/ProjectionMethodTools/ProjectionMethodToolsJava/code\>\"", 
     "]"}]}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.6172006616585565`*^9, 3.617200760638857*^9}, 
   3.6172193427493825`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", "\"\<prepPackages.mth\>\"", "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lucaEqn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"qq", "[", "t", "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"beta", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "rho"}], ")"}], "*", 
         RowBox[{"qq", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "+", 
        RowBox[{"rho", "*", 
         RowBox[{"qq", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "-", 
        RowBox[{"sigma", "*", 
         RowBox[{"rr", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"eps", "[", "uu", "]"}], "[", "t", "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"rr", "[", "t", "]"}], "-", 
      RowBox[{"phi", "*", 
       RowBox[{"qq", "[", "t", "]"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"newWeightedStochasticBasis", "[", 
  RowBox[{"lucaMod", ",", "lucaEqn"}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"stateVar", ",", "nonStateVar", ",", "theShock"}], "}"}], ",", 
      "modEqns"}], "}"}], "=", 
    RowBox[{"GenerateModelCode", "[", "lucaMod", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lucaSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"beta", "\[Rule]", 
       RowBox[{"99", "/", "100"}]}], ",", 
      RowBox[{"phi", "\[Rule]", "1"}], ",", 
      RowBox[{"rho", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"sigma", "\[Rule]", "1"}], ",", 
      RowBox[{"rUnderBar", "\[Rule]", 
       RowBox[{"2", "/", "100"}]}], ",", 
      RowBox[{"qLow", "\[Rule]", 
       RowBox[{"-", ".5"}]}], ",", 
      RowBox[{"qHigh", "\[Rule]", ".9"}], ",", 
      RowBox[{"integOrder", "\[Rule]", 
       RowBox[{"{", "5", "}"}]}], ",", 
      RowBox[{"stdDev", "\[Rule]", "0.02"}], ",", 
      RowBox[{"theMean", "\[Rule]", 
       RowBox[{"{", "0", "}"}]}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modParams", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"beta", ",", "phi", ",", "rho", ",", "sigma"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"beta", "\[Rule]", 
        RowBox[{"99", "/", "100"}]}], ",", 
       RowBox[{"phi", "\[Rule]", "1"}], ",", 
       RowBox[{"rho", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", 
       RowBox[{"sigma", "\[Rule]", "1"}], ",", 
       RowBox[{"rUnderBar", "\[Rule]", 
        RowBox[{"2", "/", "100"}]}]}], "}"}]}], "//", "N"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modEqns", "[", 
   RowBox[{"updateParams", "[", "modParams", "]"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polyRange", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"qLow", ",", "qHigh"}], "}"}], "}"}], "/.", "lucaSubs"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"initPower", "=", 
   RowBox[{"{", "2", "}"}]}], ";", 
  RowBox[{"shockPower", "=", 
   RowBox[{"{", "0", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6172193957939167`*^9, 3.6172193957939167`*^9}, {
   3.6172194525584884`*^9, 3.617219453458497*^9}, 3.6172196348013105`*^9, {
   3.617223469345704*^9, 3.6172234762057734`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "rho"}], " ", 
     RowBox[{"qq", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
    RowBox[{"qq", "[", "t", "]"}], "-", 
    RowBox[{"beta", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "rho"}], ")"}], " ", 
     RowBox[{"qq", "[", 
      RowBox[{"1", "+", "t"}], "]"}]}], "+", 
    RowBox[{"sigma", " ", 
     RowBox[{"rr", "[", "t", "]"}]}], "-", 
    RowBox[{
     RowBox[{"eps", "[", "uu", "]"}], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "phi"}], " ", 
     RowBox[{"qq", "[", "t", "]"}]}], "+", 
    RowBox[{"rr", "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.617223498495996*^9}],

Cell[BoxData["\<\"\\\"c:\\\\Program \
Files\\\\Java\\\\jdk1.7.0_51\\\\bin\\\\javac\\\" -cp \
./;ProjectionMethodToolsJava-0.0.1-SNAPSHOT.jar;Jama-1.0.2-1.0-SNAPSHOT.jar  \
-target 1.7 ./lucaMod.java\"\>"], "Print",
 CellChangeTimes->{3.617223498555997*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lucaBasis", "=", 
    RowBox[{"GenerateBasis", "[", 
     RowBox[{"stateVar", ",", 
      RowBox[{"polyRange", "//.", "lucaSubs"}], ",", "initPower", ",", 
      "theShock", ",", 
      RowBox[{"theMean", "//.", "lucaSubs"}], ",", 
      RowBox[{
       RowBox[{"{", "stdDev", "}"}], "//.", "lucaSubs"}], ",", 
      RowBox[{"integOrder", "//.", "lucaSubs"}], ",", "shockPower", ",", 
      "nonStateVar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6172193957939167`*^9, 3.6172193957939167`*^9}, {
   3.6172194525584884`*^9, 3.617219453458497*^9}, 3.6172196348013105`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numRowsCols", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"initPower", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"shockPower", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tryMat", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{".1", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "numRowsCols"}], "}"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{".2", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "numRowsCols"}], "}"}]}], "]"}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.6172253253272643`*^9, 3.6172253253272643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["tryMat"], "Input",
 CellChangeTimes->{{3.61722525988661*^9, 3.617225267466686*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.1`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "0.2`", ",", "0.2`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6172252686466975`*^9, 3.617225331707328*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"lucaBasis", "[", 
   RowBox[{"setAllWeights", "[", "tryMat", "]"}], "]"}], "\n"}]], "Input",
 CellChangeTimes->{{3.6172253483674946`*^9, 3.6172253483674946`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"LinkObject", "::", "linkd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Unable to communicate with closed link \
\[NoBreak]\\!\\(LinkObject[\\(\\(\\\"JLink-Launch556\\\", 118, 7\\)\\)]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkd\\\", ButtonNote -> \
\\\"LinkObject::linkd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6174397969053326`*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.617439797154934*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<lucaDebugDrv.mth\>\"", "]"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.6172006616585565`*^9, 3.617200760638857*^9}, 
   3.6172193427493825`*^9}],

Cell[BoxData["\<\"\\\"c:\\\\Program \
Files\\\\Java\\\\jdk1.7.0_51\\\\bin\\\\javac\\\" -cp \
./;ProjectionMethodToolsJava-0.0.1-SNAPSHOT.jar;Jama-1.0.2-1.0-SNAPSHOT.jar  \
-target 1.7 ./lucaMod.java\"\>"], "Print",
 CellChangeTimes->{
  3.617200761719559*^9, 3.617201643563635*^9, 3.6172078301308107`*^9, 
   3.617214777651548*^9, {3.617214852665548*^9, 3.6172148663255477`*^9}, 
   3.6172155599474893`*^9, {3.6172161199358287`*^9, 3.6172161313653717`*^9}, {
   3.6172164038172684`*^9, 3.6172164193692684`*^9}, 3.6172180842184334`*^9, 
   3.6172184175866146`*^9, 3.617218522111614*^9, 3.6172185708516145`*^9, 
   3.617219157974532*^9, 3.6172267221048107`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doVal", "[", 
  RowBox[{"\"\<uu$Shock\>\"", ",", 
   RowBox[{"-", "1"}], ",", "lucaBasis", ",", "tryMat"}], "]"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
  3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.617203970209613*^9, 
  3.617203994052092*^9}}],

Cell[BoxData[
 RowBox[{"doVal", "[", 
  RowBox[{"\<\"uu$Shock\"\>", ",", 
   RowBox[{"-", "1"}], ",", "lucaBasis", ",", "tryMat"}], "]"}]], "Output",
 CellChangeTimes->{
  3.617201279737127*^9, {3.617203976379737*^9, 3.617203994632104*^9}, 
   3.6172078411425905`*^9, 3.6172147884835477`*^9, {3.617214864725548*^9, 
   3.6172148709455557`*^9}, 3.617215565107541*^9, {3.617216130475407*^9, 
   3.6172161357971954`*^9}, {3.6172164187192683`*^9, 3.6172164246712685`*^9}, 
   3.6172184277066145`*^9, {3.6172185701716146`*^9, 3.6172185752416143`*^9}, 
   3.6172191779667344`*^9, 3.617219405338016*^9}]
}, Open  ]],

Cell["Values match for 0 and -1", "Text",
 CellChangeTimes->{{3.6172039244286976`*^9, 3.6172039585593805`*^9}, {
  3.617204033222844*^9, 3.617204035052862*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cmpDrvs", "[", 
   RowBox[{"\"\<qq\>\"", ",", 
    RowBox[{"-", "1"}], ",", "lucaBasis", ",", "tryMat", ",", "0.01"}], "]"}],
   "//", "Chop"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172021068579617`*^9, 
   3.6172021091682625`*^9}, {3.6172022158261304`*^9, 
   3.6172022172263126`*^9}, {3.6172034996854887`*^9, 
   3.6172035121956134`*^9}, {3.617203700695508*^9, 3.61720370290553*^9}, 
   3.617203851933243*^9, {3.617203909876404*^9, 3.6172039107864227`*^9}, {
   3.6172040074823604`*^9, 3.617204012192455*^9}}],

Cell[BoxData[
 RowBox[{"cmpDrvs", "[", 
  RowBox[{"\<\"qq\"\>", ",", 
   RowBox[{"-", "1"}], ",", "lucaBasis", ",", "tryMat", ",", "0.01`"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.617201279737127*^9, 3.617202109478303*^9, 3.6172022178263903`*^9, 
   3.6172035130256214`*^9, 3.6172035664281588`*^9, {3.6172036964454656`*^9, 
   3.617203703415535*^9}, {3.617203836472934*^9, 3.6172038594853964`*^9}, {
   3.6172039015862384`*^9, 3.61720391219645*^9}, 3.6172040131124735`*^9, 
   3.6172078412225885`*^9, 3.6172147885435476`*^9, {3.6172148650155478`*^9, 
   3.6172148710255566`*^9}, 3.6172155651875415`*^9, {3.6172161305354047`*^9, 
   3.617216135857193*^9}, {3.6172164188092685`*^9, 3.6172164247712684`*^9}, 
   3.6172184277866144`*^9, {3.6172185702616143`*^9, 3.6172185753316145`*^9}, 
   3.6172191780367355`*^9, 3.6172194053580165`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cmpDrvs", "[", 
   RowBox[{
   "\"\<qq\>\"", ",", "1", ",", "lucaBasis", ",", "tryMat", ",", "0.01"}], 
   "]"}], "//", "Chop"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172021068579617`*^9, 
   3.6172021091682625`*^9}, {3.6172022158261304`*^9, 
   3.6172022172263126`*^9}, {3.6172034996854887`*^9, 
   3.6172035121956134`*^9}, {3.617203700695508*^9, 3.61720370290553*^9}, 
   3.617203851933243*^9, {3.617203909876404*^9, 3.6172039107864227`*^9}, {
   3.6172040074823604`*^9, 3.617204029632804*^9}, {3.617281037570498*^9, 
   3.617281038490507*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.31747412336817704`"}], ",", 
     RowBox[{"-", "0.28636530121032644`"}], ",", 
     RowBox[{"-", "0.16512097193413933`"}], ",", 
     RowBox[{"-", "1.222797437883377`"}], ",", 
     RowBox[{"-", "0.4925168472897879`"}], ",", "0.7139812505283785`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.012244897959185597`", ",", "0", ",", 
     RowBox[{"-", "0.045306122448977804`"}], ",", 
     RowBox[{"-", "0.9896508820165978`"}], ",", "0.2857142857142857`", ",", 
     "0.8064736284462098`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.07610304753466268`"}], ",", "0.0650869198405365`", ",", 
     RowBox[{"-", "0.032366880225698114`"}], ",", 
     RowBox[{"-", "1.0521223133791995`"}], ",", "0.17839678418698957`", ",", 
     "0.9431797178451734`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.044325942555818454`"}], ",", 
     RowBox[{"-", "0.04981203762932351`"}], ",", 
     RowBox[{"-", "0.014889472487333077`"}], ",", 
     RowBox[{"-", "0.9785107583439366`"}], ",", "0.2145472947247094`", ",", 
     "0.9382165720043751`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.012244897959185597`", ",", "0", ",", 
     RowBox[{"-", "0.045306122448977804`"}], ",", 
     RowBox[{"-", "1.01851238328952`"}], ",", "0.2857142857142857`", ",", 
     "0.858424330737467`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00291321307195902`"}], ",", "0.0017026638970641939`", 
     ",", "0.007887528728789395`", ",", 
     RowBox[{"-", "1.007793980189421`"}], ",", "0.25059317654135077`", ",", 
     "0.8574796024792082`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.617201279737127*^9, 3.617202109478303*^9, 3.6172022178263903`*^9, 
   3.6172035130256214`*^9, 3.6172035664281588`*^9, {3.6172036964454656`*^9, 
   3.617203703415535*^9}, {3.617203836472934*^9, 3.6172038594853964`*^9}, {
   3.6172039015862384`*^9, 3.61720391219645*^9}, {3.6172040131124735`*^9, 
   3.6172040302828145`*^9}, 3.6172078412925873`*^9, 3.617214788593548*^9, {
   3.6172148650855474`*^9, 3.6172148710755568`*^9}, 3.617215565237542*^9, {
   3.6172161305854025`*^9, 3.617216135907191*^9}, {3.6172164188692684`*^9, 
   3.617216424821268*^9}, 3.6172184278366146`*^9, {3.6172185703316145`*^9, 
   3.617218575401614*^9}, 3.617219178096736*^9, 3.6172194053680162`*^9, 
   3.6172810611307335`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmpDrvs", "[", 
  RowBox[{"\"\<uu$Shock\>\"", ",", 
   RowBox[{"-", "1"}], ",", "lucaBasis", ",", "tryMat", ",", "0.01"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.617204140487922*^9, 3.6172041697312174`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6172041446079636`*^9, 3.617204170571226*^9}, 
   3.6172078413525867`*^9, 3.617214788643548*^9, 3.617214871175558*^9, 
   3.617215565287543*^9, 3.6172161359571886`*^9, 3.6172164248812685`*^9, 
   3.6172185754616146`*^9, 3.617219178146736*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cmpDrvs", "[", 
   RowBox[{
   "\"\<qq\>\"", ",", "1", ",", "lucaBasis", ",", "tryMat", ",", "0.0001"}], 
   "]"}], "//", "Chop"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172021068579617`*^9, 
   3.6172021091682625`*^9}, {3.6172022158261304`*^9, 
   3.6172022172263126`*^9}, {3.6172034996854887`*^9, 
   3.6172035121956134`*^9}, {3.617203700695508*^9, 3.61720370290553*^9}, 
   3.617203851933243*^9, {3.617203909876404*^9, 3.6172039107864227`*^9}, {
   3.6172040074823604`*^9, 3.617204029632804*^9}, {3.6172042512060375`*^9, 
   3.6172042623561487`*^9}}],

Cell[BoxData[
 RowBox[{"cmpDrvs", "[", 
  RowBox[{"\<\"qq\"\>", ",", "1", ",", "lucaBasis", ",", "tryMat", ",", 
   "0.0001`"}], "]"}]], "Output",
 CellChangeTimes->{
  3.617201279737127*^9, 3.617202109478303*^9, 3.6172022178263903`*^9, 
   3.6172035130256214`*^9, 3.6172035664281588`*^9, {3.6172036964454656`*^9, 
   3.617203703415535*^9}, {3.617203836472934*^9, 3.6172038594853964`*^9}, {
   3.6172039015862384`*^9, 3.61720391219645*^9}, {3.6172040131124735`*^9, 
   3.6172040302828145`*^9}, {3.6172042530360556`*^9, 3.617204263416159*^9}, 
   3.6172078414225845`*^9, 3.6172147886935477`*^9, {3.617214865145548*^9, 
   3.6172148712255583`*^9}, 3.6172155653275433`*^9, {3.6172161306254015`*^9, 
   3.617216135997187*^9}, {3.6172164189192686`*^9, 3.6172164249312687`*^9}, 
   3.6172184278766146`*^9, {3.6172185703916144`*^9, 3.617218575521614*^9}, 
   3.617219178196737*^9, 3.6172194053880167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmpDrvs", "[", 
  RowBox[{
  "\"\<rr\>\"", ",", "1", ",", "lucaBasis", ",", "tryMat", ",", "0.0001"}], 
  "]"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172021068579617`*^9, 
   3.6172021091682625`*^9}, {3.6172022158261304`*^9, 
   3.6172022172263126`*^9}, {3.6172034996854887`*^9, 
   3.6172035121956134`*^9}, {3.617203700695508*^9, 3.61720370290553*^9}, 
   3.617203851933243*^9, {3.617203909876404*^9, 3.6172039107864227`*^9}, {
   3.6172040074823604`*^9, 3.617204029632804*^9}, {3.6172042512060375`*^9, 
   3.6172042623561487`*^9}, {3.6172078949335155`*^9, 
   3.6172078955835023`*^9}, {3.6172080829197583`*^9, 3.617208091699583*^9}, {
   3.617216103616482*^9, 3.6172161063463726`*^9}, 3.6172161559563885`*^9}],

Cell[BoxData[
 RowBox[{"cmpDrvs", "[", 
  RowBox[{"\<\"rr\"\>", ",", "1", ",", "lucaBasis", ",", "tryMat", ",", 
   "0.0001`"}], "]"}]], "Output",
 CellChangeTimes->{
  3.6172161565663643`*^9, {3.6172164189892683`*^9, 3.6172164250512686`*^9}, 
   3.6172184279266143`*^9, {3.6172185704616146`*^9, 3.6172185756316147`*^9}, 
   3.6172191782667375`*^9, 3.6172194054080167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"doDrv", "[", 
   RowBox[{"\"\<qq\>\"", ",", "1", ",", "lucaBasis", ",", "tryMat"}], "]"}], "//",
   "Chop"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172021068579617`*^9, 
   3.6172021091682625`*^9}, {3.6172022158261304`*^9, 
   3.6172022172263126`*^9}, {3.6172034996854887`*^9, 
   3.6172035121956134`*^9}, {3.617203700695508*^9, 3.61720370290553*^9}, 
   3.617203851933243*^9, {3.617203909876404*^9, 3.6172039107864227`*^9}, {
   3.6172040074823604`*^9, 3.617204029632804*^9}, {3.6172042512060375`*^9, 
   3.6172042623561487`*^9}, {3.6172044197177343`*^9, 
   3.6172044461779985`*^9}, {3.617206096187196*^9, 3.6172060970371876`*^9}, {
   3.617206291613243*^9, 3.617206319636963*^9}, {3.617206658953379*^9, 
   3.617206676763379*^9}}],

Cell[BoxData[
 RowBox[{"doDrv", "[", 
  RowBox[{"\<\"qq\"\>", ",", "1", ",", "lucaBasis", ",", "tryMat"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.617201279737127*^9, 3.617202109478303*^9, 3.6172022178263903`*^9, 
   3.6172035130256214`*^9, 3.6172035664281588`*^9, {3.6172036964454656`*^9, 
   3.617203703415535*^9}, {3.617203836472934*^9, 3.6172038594853964`*^9}, {
   3.6172039015862384`*^9, 3.61720391219645*^9}, {3.6172040131124735`*^9, 
   3.6172040302828145`*^9}, {3.6172042530360556`*^9, 3.617204263416159*^9}, 
   3.6172044480980177`*^9, {3.6172060929072285`*^9, 3.6172060977771797`*^9}, {
   3.6172062859132996`*^9, 3.6172063202369576`*^9}, {3.617206660203379*^9, 
   3.617206677423379*^9}, 3.6172078415125833`*^9, 3.617214788863548*^9, {
   3.6172148652655478`*^9, 3.617214871465561*^9}, 3.6172155655475454`*^9, 
   3.617215751337414*^9, {3.6172161309153895`*^9, 3.617216136277176*^9}, {
   3.6172164190192685`*^9, 3.6172164250812683`*^9}, 3.6172184279466143`*^9, {
   3.617218570481614*^9, 3.617218575651614*^9}, 3.6172191783267384`*^9, 
   3.617219405418017*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doVal", "[", 
  RowBox[{"\"\<rr\>\"", ",", "1", ",", "lucaBasis", ",", "tryMat"}], 
  "]"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172013038488145`*^9, 
   3.6172013063789916`*^9}, 3.617201819127837*^9, {3.617201872045823*^9, 
   3.6172018749268026`*^9}, {3.6172021603269143`*^9, 
   3.6172021606969624`*^9}, {3.617202527223632*^9, 3.6172025333139973`*^9}, {
   3.6172048159369307`*^9, 3.6172048327285957`*^9}, 3.6172058707195926`*^9, {
   3.617205970974588*^9, 3.617205980804293*^9}, {3.6172060571260047`*^9, 
   3.6172060579159813`*^9}, {3.6172061718684397`*^9, 3.617206215152007*^9}}],

Cell[BoxData[
 RowBox[{"doVal", "[", 
  RowBox[{"\<\"rr\"\>", ",", "1", ",", "lucaBasis", ",", "tryMat"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.617201279737127*^9, 3.617201307029037*^9}, 
   3.61720182251899*^9, 3.6172018754769897`*^9, 3.617202161717095*^9, {
   3.617204821808814*^9, 3.617204833298584*^9}, 3.6172058713295746`*^9, {
   3.617205973044526*^9, 3.617205981404275*^9}, {3.6172060488362536`*^9, 
   3.6172060588259535`*^9}, {3.617206168308475*^9, 3.6172062160319986`*^9}, 
   3.6172078417825775`*^9, 3.6172147892935476`*^9, {3.6172148658455477`*^9, 
   3.617214871845565*^9}, 3.617215565957549*^9, {3.617216130995386*^9, 
   3.617216136357173*^9}, {3.6172164190492687`*^9, 3.6172164251012683`*^9}, 
   3.6172184279566145`*^9, {3.6172185705116143`*^9, 3.6172185757016144`*^9}, 
   3.617219178346738*^9, 3.617219405438017*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"doDrv", "[", 
   RowBox[{"\"\<rr\>\"", ",", "1", ",", "lucaBasis", ",", "tryMat"}], "]"}], "//",
   "Chop"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
   3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172021068579617`*^9, 
   3.6172021091682625`*^9}, {3.6172022158261304`*^9, 
   3.6172022172263126`*^9}, {3.6172034996854887`*^9, 
   3.6172035121956134`*^9}, {3.617203700695508*^9, 3.61720370290553*^9}, 
   3.617203851933243*^9, {3.617203909876404*^9, 3.6172039107864227`*^9}, {
   3.6172040074823604`*^9, 3.617204029632804*^9}, {3.6172042512060375`*^9, 
   3.6172042623561487`*^9}, {3.6172044197177343`*^9, 
   3.6172044461779985`*^9}, {3.617204657552129*^9, 3.61720465867214*^9}}],

Cell[BoxData[
 RowBox[{"doDrv", "[", 
  RowBox[{"\<\"rr\"\>", ",", "1", ",", "lucaBasis", ",", "tryMat"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.617201279737127*^9, 3.617202109478303*^9, 3.6172022178263903`*^9, 
   3.6172035130256214`*^9, 3.6172035664281588`*^9, {3.6172036964454656`*^9, 
   3.617203703415535*^9}, {3.617203836472934*^9, 3.6172038594853964`*^9}, {
   3.6172039015862384`*^9, 3.61720391219645*^9}, {3.6172040131124735`*^9, 
   3.6172040302828145`*^9}, {3.6172042530360556`*^9, 3.617204263416159*^9}, 
   3.6172044480980177`*^9, 3.6172046595321484`*^9, 3.6172063749164104`*^9, 
   3.6172078418225765`*^9, 3.617214789323548*^9, {3.617214865865548*^9, 
   3.617214871875565*^9}, 3.61721556598755*^9, {3.6172161310153856`*^9, 
   3.617216136397171*^9}, {3.6172164190892687`*^9, 3.6172164251412687`*^9}, 
   3.6172184279766145`*^9, {3.6172185705316143`*^9, 3.6172185757516146`*^9}, 
   3.617219178386739*^9, 3.6172194054580173`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doNumDrv", "[", 
  RowBox[{"\"\<rr\>\"", ",", "0", ",", "lucaBasis", ",", "tryMat", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", "0.01"}], "]"}]], "Code",
 CellChangeTimes->{{3.617201067733345*^9, 3.6172011216772127`*^9}, {
  3.6172012149297266`*^9, 3.6172012307352047`*^9}, {3.6172013038488145`*^9, 
  3.6172013063789916`*^9}, {3.6172013788160625`*^9, 3.6172013940871315`*^9}, {
  3.617201726890482*^9, 3.617201772467975*^9}, {3.61720217029821*^9, 
  3.6172021714683623`*^9}, {3.6172067148777466`*^9, 3.6172067569901705`*^9}, {
  3.617215681114709*^9, 3.6172156898247957`*^9}}],

Cell[BoxData[
 RowBox[{"doNumDrv", "[", 
  RowBox[{"\<\"rr\"\>", ",", "0", ",", "lucaBasis", ",", "tryMat", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", "0.01`"}], "]"}]], "Output",
 CellChangeTimes->{
  3.6172017032724547`*^9, 3.617201773798427*^9, 3.617201920794394*^9, 
   3.617202065322563*^9, 3.6172021721284485`*^9, {3.617206716297761*^9, 
   3.617206757610177*^9}, 3.6172078420525723`*^9, 3.6172147895035477`*^9, {
   3.6172148660755477`*^9, 3.6172148721355677`*^9}, 3.617215566217552*^9, 
   3.617215610657996*^9, 3.617215642722322*^9, {3.6172156849047465`*^9, 
   3.6172156902948003`*^9}, {3.6172161310453844`*^9, 3.617216136527166*^9}, {
   3.617216419149268*^9, 3.6172164251812687`*^9}, 3.6172184280066147`*^9, {
   3.6172185706016145`*^9, 3.6172185757916145`*^9}, 3.6172191784267387`*^9, 
   3.6172194054680176`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lucaBasisNew", "=", 
    RowBox[{"GenerateBasis", "[", 
     RowBox[{"stateVar", ",", 
      RowBox[{"polyRange", "//.", "lucaSubs"}], ",", "initPower", ",", 
      "theShock", ",", 
      RowBox[{"theMean", "//.", "lucaSubs"}], ",", 
      RowBox[{
       RowBox[{"{", "stdDev", "}"}], "//.", "lucaSubs"}], ",", 
      RowBox[{"integOrder", "//.", "lucaSubs"}], ",", "shockPower", ",", 
      "nonStateVar"}], "]"}]}], ";"}], "\n"}]], "Input",
 CellChangeTimes->{{3.6172164381312685`*^9, 3.6172164381312685`*^9}, {
  3.6172164775912685`*^9, 3.6172164783112683`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["lucaBasisNew"], "Input",
 CellChangeTimes->{{3.6172192032469873`*^9, 3.6172192220971756`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{
    "gov", ".", "frb", ".", "ma", ".", "msu", ".", 
     "ProjectionMethodToolsJava", ".", "WeightedStochasticBasis"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm2`JavaObject20220930458386433]], "Output",
 CellChangeTimes->{3.6172192272072268`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{783, 878},
WindowMargins->{{358, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]

