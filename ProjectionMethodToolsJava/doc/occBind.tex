\documentclass[12pt]{article}
\title{A Solution Strategy for Occasionally Binding Constraints in Otherwise
Linear Rational Expectations Models}
\author{Gary S. Anderson}
\usepackage{datetime}
\usepackage{amsmath}
\begin{document}
\maketitle
Consider systems of the form
\newcommand{\xpt}[1]{\mathcal{E}_t \left ( #1 \right ) }

\begin{gather*}
\sum_{i=-\tau}^\theta H_i x_{t+i} =
\begin{bmatrix}
\psi_\epsilon & \psi_z  
\end{bmatrix}
  \begin{bmatrix}
\epsilon_t \\\xpt{z_{t+s}(x_{t+s-1},\epsilon_t) }   
  \end{bmatrix}
  \,\,\forall t \intertext{Solutions will take the form}
  x_t=B x_{t-1}+\sum_{s=0}^\infty F^s \phi \psi
  \begin{bmatrix}
\epsilon_t \\\xpt{z_{t+s}(x_{t+s-1},\epsilon_t)    }
  \end{bmatrix}
% \intertext{ if $z_{t+s}=z^\ast, \forall s$}
%   x_t=B x_{t-1}+(z_t(x_{t-1},\epsilon_t) - \xpt{z^\ast(x_{t-1},\epsilon_{t+s})}(I-F)^{-1} \phi \psi
%   \begin{bmatrix}
% \epsilon_t \\z^\ast(x_{t-1},\epsilon_t)    
%   \end{bmatrix}\intertext{ if $z_{t+s}=z^\ast, \forall s$}
\end{gather*}
To consider inequality constraints of the form
\begin{gather*}
  x_t \ge \bar{m}
\end{gather*}
we will determine a sequence of $z^i_t$ that 
will allow us to
 impose the constraints over successively longer time periods.  
We begin by solving a system where the constraints are honored only at time
 $t=0$.  To do this we set $\xpt{z_{t+s}}=0\, \forall s>0$\footnote{Generalize to linear combinations of variables. \begin{gather*}
M x_t \ge m  
\end{gather*}.   What about other behavior besides absorbing barriers.
}
\newcommand{\forPhi}{\begin{bmatrix}
\psi_\epsilon&I
\end{bmatrix}}
\newcommand{\phiMult}{\phi \psi}
\newcommand{\bMult}{B x_{t-1} + \phiMult}

We set 
\begin{gather}\label{firstIneq}
z_t(x_{t-1},\epsilon_t)=
\begin{cases}
0&  B_1 x_{t-1} +\epsilon_t \ge \bar{x}_1  \\
\bar{x}_1-(B x_{t-1}+\epsilon_t) & B_1 x_{t-1}+\epsilon_t < \bar{x}_1  
\end{cases}\intertext{ and}
\psi=\forPhi
\end{gather}
We can use equations \ref{firstIneq} to compute the expected value function $Z_t^1(x_{t})=E_{t}[z_{t+1}(x_t,\epsilon_{t+1})]$.  We will use this in 
our next calculation as the value for $z_{t+1}$.  In so doing we will be able to
capture the impact of imposing
the constraint at time t+1 as well as time t.

The next step, in general requires the solution of a nonlinear equation as $x_t$ appears in side the function $Z_t^1$.  We begin will apply a projection method to approximate the function that solves

\newcommand{\bForTwo}{\bMult
  \begin{bmatrix}
\epsilon_t \\0
  \end{bmatrix}+ F \phi  \psi  \begin{bmatrix}
0 \\Z_t^1(x^2_{t}(x_{t-1}))   
  \end{bmatrix} 
}
\newcommand{\zForTwo}{
\bMult
  \begin{bmatrix}
\epsilon_t \\z_{t}(x_{t-1},\epsilon_t)    
  \end{bmatrix}+ F \phi   \begin{bmatrix}
0 \\Z_t^1(x_{t})   
  \end{bmatrix}
}

\newcommand{\bForK}{\bMult
  \begin{bmatrix}
\epsilon_t \\0
  \end{bmatrix}+ \sum_{i=0}^{k-1} F^i \phi  \psi  \begin{bmatrix}
0 \\Z_t^{i-1}(x_{t+i}(x_{t-1}))   
  \end{bmatrix} 
}
\newcommand{\zForK}{
\bMult
  \begin{bmatrix}
\epsilon_t \\z^k_{t}(x_{t-1},\epsilon_t)    
  \end{bmatrix}+ F \phi   \begin{bmatrix}
0 \\Z_t^k(x_{t})   
  \end{bmatrix}
}


We now have
\begin{gather*}
x_t(x_{t-1})=
\left (
\bForTwo
\right )
\end{gather*}

We set 
\begin{gather*}
z_t(x_{t-1},\epsilon_t)=
\begin{cases}
0&  \mathcal{M}_2 \ge \bar{x}_1  \\
\bar{x}_1-
\mathcal{M}_2 &\mathcal{M}_2 < \bar{x}_1  
\end{cases}\intertext{where}
\mathcal{M}_2= \left (
\bForTwo
\right )
\end{gather*}

\begin{gather*}
  x_t=
\left (
\zForTwo
\right )
\end{gather*}


We now have

\begin{gather*}
x_t(x_{t-1})-
\left (
\bForK
\right )
\end{gather*}

We set 
\begin{gather*}
z_t(x_{t-1},\epsilon)=
\begin{cases}
0&  \mathcal{M}_k \ge \bar{x}_1  \\
\bar{x}_1-
\mathcal{M}_k &\mathcal{M}_k < \bar{x}_1  
\end{cases}\intertext{where}
\mathcal{M}_k= \left (
\bForK
\right )
\end{gather*}

\begin{gather*}
  x_t^k=
\left (
\zForK
\right )
\end{gather*}

Consider the equations 
\begin{gather*}
q_{t} +\beta_p(1 - \rho_p)q_{t + 1} + \rho_pq_{t - 1} - \sigma_pr_{t} +
     r_{ut}=0\\
 r_{t} = \max (\bar{r}, \phi_pq_{t}) \\
 r_{ut} = \rho_{ru} r_{ut - 1} + \eta \epsilon_{y,t}
\end{gather*}

Some typical values of the parameters are:

\begin{gather*}
  betap -> 99/100, phip -> 1, \\
rhop -> 1/2, sigmap -> 1, 
  \bar{r} -> 2/100, \\
q^L -> -.5, q^H -> .5, 
  r_u^L -> -4 \sigma_u/(1 - \rho_{ru}), r_u^H->  4\sigma_u/(1 - \rho_{ru}),
   I_N -> {10}, \sigma_u -> 0.02,\\
 \mu -> {0},\rho_{ru} -> 0.5,
   \eta -> 1
\end{gather*}


\begin{gather*}
  B=   \left(
   \begin{array}{ccc}
    \frac{2 \rho _p}{\nu +\phi _p \sigma _p+1} & 0 & \frac{2 \rho _u}{\nu +2
      \beta _p \left(\rho _p-1\right) \rho _u+\phi _p \sigma _p+1} \\
    \frac{2 \phi _p \rho _p}{\nu +\phi _p \sigma _p+1} & 0 & \frac{2 \phi _p
      \rho _u}{\nu +2 \beta _p \left(\rho _p-1\right) \rho _u+\phi _p \sigma
      _p+1} \\
    0 & 0 & \rho _u
   \end{array}
   \right)
\end{gather*}




\begin{gather*}
  \phi=   \left(
   \begin{array}{ccc}
    \frac{2}{\nu +\phi _p \sigma _p+1} & \frac{2}{\nu +2 \beta _p \left(\rho
      _p-1\right) \rho _u+\phi _p \sigma _p+1} & -\frac{2 \sigma _p}{\nu +\phi
      _p \sigma _p+1} \\
    \frac{2 \phi _p}{\nu +\phi _p \sigma _p+1} & \frac{2 \phi _p}{\nu +2 \beta
      _p \left(\rho _p-1\right) \rho _u+\phi _p \sigma _p+1} & \frac{2 \beta
      _p \left(\rho _p-1\right) \rho _p+\phi _p \sigma _p \left(-\nu +\phi _p
      \sigma _p+1\right)}{2 \beta _p \left(\rho _p-1\right) \rho _p} \\
    0 & 1 & 0
   \end{array}
   \right)
\end{gather*}

\begin{gather*}
  F=    \left(
   \begin{array}{ccc}
    \frac{\phi _p \sigma _p-\sqrt{\left(\phi _p \sigma _p+1\right){}^2+4 \beta
      _p \left(\rho _p-1\right) \rho _p}+1}{2 \rho _p} & 0 & 0 \\
    \frac{\phi _p \left(\phi _p \sigma _p-\sqrt{\left(\phi _p \sigma
      _p+1\right){}^2+4 \beta _p \left(\rho _p-1\right) \rho _p}+1\right)}{2
      \rho _p} & 0 & 0 \\
    0 & 0 & 0
   \end{array}
   \right)
\end{gather*}

Where
\begin{gather*}
  \nu=    \sqrt{4 \beta _p \left(\rho _p-1\right) \rho _p+\left(\phi _p \sigma
    _p+1\right){}^2}
\end{gather*}

\newcommand{\tVec}{
  \begin{bmatrix}
    q_t\\r_{rt}\\r_{ut}
  \end{bmatrix}}


Applying the formula produces
\begin{gather*}
\tVec=      \left(
   \begin{array}{c}
    2 \left(\frac{q_{t-1} \rho _p}{\nu +\phi _p \sigma _p+1}+\frac{\epsilon
      _t+r_{\text{ut}-1} \rho _u}{\nu +2 \beta _p \left(\rho _p-1\right) \rho
      _u+\phi _p \sigma _p+1}\right)+\frac{\sigma _p
      \left(\text{Exptn}\left(z_{t+1}\right) \left(\nu -\phi _p \sigma
      _p-1\right)-2 \rho _p z_t\right)}{\rho _p \left(\nu +\phi _p \sigma
      _p+1\right)} \\
    2 \phi _p \left(\frac{q_{t-1} \rho _p}{\nu +\phi _p \sigma
      _p+1}+\frac{\epsilon _t+r_{\text{ut}-1} \rho _u}{\nu +2 \beta _p
      \left(\rho _p-1\right) \rho _u+\phi _p \sigma
      _p+1}\right)+\frac{\text{Exptn}\left(z_{t+1}\right) \phi _p \sigma _p
      \left(\nu -\phi _p \sigma _p-1\right)+\rho _p \left(\nu -\phi _p \sigma
      _p+1\right) z_t}{\rho _p \left(\nu +\phi _p \sigma _p+1\right)} \\
    \epsilon _t+r_{\text{ut}-1} \rho _u
   \end{array}
   \right)
\end{gather*}

For the numerical values above
\begin{gather*}
\tVec=    \left(
   \begin{array}{c}
    -0.141938 \text{Exptn}\left(z_{t+1}\right)+0.617296 \epsilon _t+0.267742
      q_{t-1}+0.308648 r_{\text{ut}-1}-0.535485 z_t \\
    -0.141938 \text{Exptn}\left(z_{t+1}\right)+0.617296 \epsilon _t+0.267742
      q_{t-1}+0.308648 r_{\text{ut}-1}+0.464515 z_t \\
    \epsilon _t+0.5 r_{\text{ut}-1}
   \end{array}
   \right)
\end{gather*}

Imposing constraits generates a nonlinear set of equations to solve.
The solution, including the expectation term incorporates the impact of the
constraint on this and the next period.

Alternatively, for imposing the constraints throughout time one gets

\begin{gather*}
\tVec=    \left(
   \begin{array}{c}
    -0.19313 \text{Exptn}\left(z_{t+1}\right)+0.617296 \epsilon _t+0.267742
      q_{t-1}+0.308648 r_{\text{ut}-1}-0.535485 z_t \\
    -0.19313 \text{Exptn}\left(z_{t+1}\right)+0.617296 \epsilon _t+0.267742
      q_{t-1}+0.308648 r_{\text{ut}-1}+0.464515 z_t \\
    \epsilon _t+0.5 r_{\text{ut}-1}
   \end{array}
   \right)
\end{gather*}
\end{document}
p
